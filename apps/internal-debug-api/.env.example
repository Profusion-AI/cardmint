# Internal Debug API Configuration
# Copy to .env and fill in values

# =============================================================================
# SECURITY (Required)
# =============================================================================

# Bearer token for API authentication (required)
INTERNAL_DEBUG_TOKEN=replace-with-secure-token

# Optional: Comma-separated IP allowlist (empty = no IP filtering)
INTERNAL_ALLOWED_IPS=

# Optional: Comma-separated trusted proxy IPs (only then X-Forwarded-For is honored)
INTERNAL_TRUSTED_PROXIES=

# =============================================================================
# POSTGRESQL
# =============================================================================

# Docker network hostname (prod) or localhost with SSH tunnel (dev)
POSTGRES_HOST=database
POSTGRES_PORT=5432
POSTGRES_USER=evershop
POSTGRES_PASSWORD=
POSTGRES_DB=evershop

# Connection pool settings
POSTGRES_POOL_MIN=1
POSTGRES_POOL_MAX=5
POSTGRES_CONNECT_TIMEOUT=10

# Write role guardrails (CRUD requires Kyle approval + BTFRS snapshot)
DB_WRITE_ENABLED=false
DB_WRITE_APPROVED=false
DB_BTFRS_SNAPSHOT=false

# =============================================================================
# EVERSHOP
# =============================================================================

# GraphQL endpoint (internal Docker network in prod)
EVERSHOP_GRAPHQL_URL=http://evershop:3000/api/graphql

# Admin token for authenticated queries (optional)
EVERSHOP_ADMIN_TOKEN=

# =============================================================================
# RATE LIMITING (requests per minute)
# =============================================================================

RATE_LIMIT_DB_RPM=10
RATE_LIMIT_EVERSHOP_RPM=5
RATE_LIMIT_LOGS_RPM=2

# =============================================================================
# EXECUTION LIMITS
# =============================================================================

# Max command execution time in seconds
COMMAND_TIMEOUT_SEC=10

# Max response size in bytes (truncated if exceeded)
MAX_OUTPUT_BYTES=65536

# Max log lines per tail request
MAX_LOG_LINES=500

# =============================================================================
# LOG SOURCES (Fixed paths - allowlist only)
# =============================================================================

# Nginx logs (fixed paths on host)
LOG_SOURCE_NGINX_ACCESS=/var/log/nginx/access.log
LOG_SOURCE_NGINX_ERROR=/var/log/nginx/error.log

# CardMint backend: journalctl unit name OR file path
# Example: cardmint-backend (for journalctl -u cardmint-backend)
# Example: /var/log/cardmint/backend.log (for file)
LOG_SOURCE_CARDMINT_BACKEND=

# Docker container names for log access
# File paths for service logs (no Docker socket usage)
LOG_SOURCE_EVERSHOP_FILE=
LOG_SOURCE_POSTGRES_FILE=

# =============================================================================
# LOGGING
# =============================================================================

LOG_LEVEL=INFO
